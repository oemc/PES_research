---
title: "Official Development Assistance and Institutional Quality on Undeveloped countries"
author: "Oscar Eduardo Morales Cárdenas"
date: "2024-08-05"
output:
  html_document:
    df_print: paged
  html_notebook: default
  pdf_document: default
---


International aid may take the form of multilateral aid – provided through international bodies such as the UN, or NGOs such as Oxfam – or bilateral aid, which operates on a government-to-government basis. There is considerable debate about whether international aid works, in the sense of reducing poverty and stimulating development.

However, the effectiveness of aid is often diluted by corruption. Aid is invariably channeled through the governments of recipient countries, in which power is often concentrated in the hands of a few politicians and bureaucrats, and the mechanisms of accountability are, at best, poorly developed. This tends to benefit corrupt leaders and elites rather than the people, projects and programs for which it was intended.

\textbf{Watts, Carl. (2014). Re: Does foreign aid help the developing countries towards development?. Retrieved from: $https://www.researchgate.net/post/Does_foreign_aid_help_the_developing_countries_towards_development/5322005ed039b1e7648b459c/citation/download.$}


The hypothesis that foreign aid can promote growth in developing countries was explored, using panel data series for foreign aid, while accounting for regional differences in Asian, African, Latin American, and the Caribbean countries as well as the differences in income levels, the results of this study also indicate that foreign aid has mixed effects on economic growth in developing countries.

\textbf{Ekanayake, E. & Chatrna, Dasha. (2010). The effect of foreign aid on economic growth in developing countries. Journal of International Business and Cultural Studies. 3.}


This study examines the relationships between foreign aid, institutional structure, and economic performance for 80 countries in Europe, America, Africa, and Asia. It is found that official development assistance and the quality of institutional structure in the sample countries affect economic growth positively.

\textbf{Hayaloğlu, Pınar. (2023). Foreign Aid, Institutions, and Economic Performance in Developing Countries. Eskişehir Osmangazi Üniversitesi İktisadi ve İdari Bilimler Dergisi. 18. 748-765. 10.17153/oguiibf.1277348.}

# Cargando Librerias

Algunas librerias y paquetes usados para obtener y descargar los datos

```{r}
library(tidyverse) # manejo de dataframes
library(WDI)       # libreria para acceder a metadata de banco mundial
library(readxl)    # leer archivos de excel
library(readr)     # leer archivos csv
library(visdat)    # visualizacion de datos como graficos
library(plotly)    # graficos
library(purrr)     # funcion map
library(plm)       # modelos lineales para datos panel
```

# Obtener datos

Datos para paises bajos ingresos sean utilizados, segun clasificación del banco mundial, hay 26 paises de bajos ingresos y 51 de ingresos medios bajos

```{r}
country_class <- read_excel("CLASS.xlsx")

country_class %>%
  filter(!is.na(Region), !is.na(`Income group`)) %>%
  group_by(`Income group`) %>%
  summarise(countries = n())
```

Listado de paises a analisar:

```{r}
my_countries <- country_class %>%
  filter(!is.na(Region), `Income group` %in% c('Low income', 'Lower middle income')) %>%
  select(Code)
my_countries
```

Hacer la respectiva asociacion de nombres iso3c e iso2c

```{r}
my_countries$iso2c <- WDI_data$country %>%
  filter(iso3c %in% my_countries$Code) %>%
  .$iso2c
my_countries
```

Datos del banco mundial (para ODA y los indices de gobernanza) y el Human Development Reports API son descargados desde scripts de Python.
Son almacenados en archivos CSV y luego son cargados aqui:

## HDI

```{r}
datos_HDI <- read_csv("datos_python_HDI.csv", col_names = c('Code', 'iso2c', 'indicator', 'year', 'value'), 
                      col_types = list(col_character(), col_character(), col_character(), col_double(), col_double()))

hdi_indicators <- datos_HDI %>% distinct(indicator) %>% .$indicator
```

## ODA

```{r}
oda_indicators <- c(
'DT_ODA_ALLD_CD',
'DT_ODA_ALLD_KD',
'DT_ODA_OATL_CD',
'DT_ODA_OATL_KD',
'DT_ODA_ODAT_CD',
'DT_ODA_ODAT_GI_ZS',
'DT_ODA_ODAT_GN_ZS',
'DT_ODA_ODAT_KD',
'DT_ODA_ODAT_MP_ZS',
'DT_ODA_ODAT_PC_ZS',
'DT_ODA_ODAT_XP_ZS'
)
gob_indicators <- c(
'CC_EST',
'CC_NO_SRC',
'CC_PER_RNK',
'CC_PER_RNK_LOWER',
'CC_PER_RNK_UPPER',
'CC_STD_ERR',
'GE_EST',
'GE_NO_SRC',
'GE_PER_RNK',
'GE_PER_RNK_LOWER',
'GE_PER_RNK_UPPER',
'GE_STD_ERR',
'PV_EST',
'PV_NO_SRC',
'PV_PER_RNK',
'PV_PER_RNK_LOWER',
'PV_PER_RNK_UPPER',
'PV_STD_ERR',
'RQ_EST',
'RQ_NO_SRC',
'RQ_PER_RNK',
'RQ_PER_RNK_LOWER',
'RQ_PER_RNK_UPPER',
'RQ_STD_ERR',
'RL_EST',
'RL_NO_SRC',
'RL_PER_RNK',
'RL_PER_RNK_LOWER',
'RL_PER_RNK_UPPER',
'RL_STD_ERR',
'VA_EST',
'VA_NO_SRC',
'VA_PER_RNK',
'VA_PER_RNK_LOWER',
'VA_PER_RNK_UPPER',
'VA_STD_ERR'
)
gdp_indicators <- c(
'NY_ADJ_NNTY_PC_CD',
'NY_ADJ_NNTY_PC_KD',
'NY_ADJ_NNTY_PC_KD_ZG',
'NY_GDP_PCAP_CN',
'NY_GDP_PCAP_KN',
'NY_GDP_PCAP_CD',
'NY_GDP_PCAP_KD',
'NY_GDP_MKTP_KD_ZG',
'NY_GDP_DEFL_ZS_AD',
'NY_GDP_DEFL_ZS',
'NY_GDP_MKTP_CD',
'NY_GDP_MKTP_CN',
'NY_GDP_MKTP_KN',
'NY_GDP_MKTP_KD',
'NY_GDP_PCAP_KD_ZG',
'NY_GDP_PCAP_PP_KD',
'NY_GDP_PCAP_PP_CD',
'SL_GDP_PCAP_EM_KD',
'SP_POP_GROW'
)

datos_WB <- data.frame(indicator = character(), iso2c = character(), year = double(), value = double())

suppressWarnings(
  for (indicator in c(oda_indicators, gob_indicators, gdp_indicators)) {
    datos_WB <- rbind(datos_WB, read_csv(paste("datos_python", indicator, ".csv", sep =''), 
                                           col_names = c('indicator', 'iso2c', 'year', 'value'),
                                           col_types = list(col_character(), col_character(), col_double(), col_double())))
  }
)
```

# Manipulacion de Datos

Transformar la estructura de los datos para una mejor comprension

```{r}
datos_paper <- rbind(datos_WB, datos_HDI %>% select(indicator, iso2c, year, value)) %>%
  pivot_wider(names_from = indicator, values_from = value)
```

Revisar que datos estan como faltantes


```{r}
vis_dat(datos_paper %>% select(all_of(gsub("_", ".", oda_indicators)))) 
  # DT.ODA.OATL.CD and DT.ODA.OATL.KD faltan
  # DT.ODA.ODAT.GI.ZS, DT.ODA.ODAT.GN.ZS, DT.ODA.ODAT.MP.ZS and DT.ODA.ODAT.XP.ZS tienen faltas
  # Un par de ocurrencias pais-año que faltan datos

vis_dat(datos_paper %>% select(NY.GDP.PCAP.CN, NY.GDP.PCAP.CD)) 
  # NY.GDP.PCAP.CN, NY.GDP.PCAP.CD, NY.GDP.MKTP.CD, NY.GDP.MKTP.CN son buenos candidatos, 
  # 'SY'falta PIB per Capita en 2022, 2023 sin datos algunos paises

vis_dat(datos_paper %>% arrange(year) %>% select(all_of(gsub("_", ".", gob_indicators)))) 
  # Datos del 2000 para atras tienen espacios faltantes 

vis_dat(datos_paper %>% select(all_of(hdi_indicators))) 
  # abr, co2_prod, le, le_f, le_m, mmr son las pocas categorias sin datos faltantes

vis_dat(datos_paper %>% arrange(year) %>% select(hdi)) 
  # hdi faltante en multiples ocaciones

vis_dat(datos_paper %>% arrange(iso2c) %>% select(SP.POP.GROW)) 
  # ZW no tiene datos de crecimiento poblacional

```

Tomando en cuenta los datos faltantes, hacer filtros para seleccionar una muestra mas pequeña
```{r}
# 2023 aun no tiene registro en ODA
datos_paper %>% filter(is.na(DT.ODA.ALLD.CD), !year %in% c(2023)) ## SS (South Sudan) y ZW (Zimbabwe) faltantes de ODA y GOB indicators

datos_paper %>% filter(!iso2c %in% c('SS', 'ZW')) %>% filter(is.na(CC.EST)) %>% group_by(year) %>% summarise(times = n())
# para años 1995, 1997, 1999, 2001 y 2023 no hay registros de GOB
# 1996, 1998, 2000, 2002 and 2003 tiene algunos paises sin datos
datos_paper %>% arrange(year) %>% filter(!iso2c %in% c('SS', 'ZW'), !year %in% c(1995, 1997, 1999, 2001, 2023)) %>%
                filter(is.na(CC.EST)) # FM (Micronesia), KI (Kiribati) y TL (Timor-Leste) no tiene GOB in en estos años 
                                      # tambien CV (Cabo Verde) and SB (Solomon Islands) no registro GOB en 2000 - 2003
datos_paper %>% arrange(iso2c) %>% 
          filter(!iso2c %in% c('SS','ZW','BT','ER','GW','KP','LB','NG','PS','SO','VU','FM','KI','TL','CB','CV','SB'), 
                 !year %in% c(1995, 1996, 1997, 1998, 1999, 2000, 2001, 2023)) %>%
          select(iso2c, year, hdi,
                 all_of(gsub("_", ".", gob_indicators))
                 )
# Ver datos aplicando los filtros determinados en las busquedas pasadas
# antes del 2001 suele tener informacion faltante
# BT (Bhutan), ER (Eritrea), GW (Guinea-Bissau), KP (North Korea), LB (Lebanon), NG (Nigeria), PS (Palestine), SO (Somalia), VU (Vanuatu) son paises # sin registro de hdi
```


```{r}
datos_paper %>% 
        filter(!iso2c %in% c('SS', 'ZW', 'BT', 'ER', 'GW', 'KP', 'LB', 'NG', 'PS', 'SO', 'VU', 'FM', 'KI', 'TL', 'CV', 'SB','SY'),
               !year %in% c(1995, 1996, 1997, 1998, 1999, 2000, 2023)) %>%
        select(iso2c, year, hdi, DT.ODA.ALLD.CD, DT.ODA.ALLD.KD, DT.ODA.ODAT.CD, DT.ODA.ODAT.KD, DT.ODA.ODAT.PC.ZS, 
               NY.GDP.PCAP.CN, NY.GDP.PCAP.CD, SP.POP.GROW, all_of(gsub("_", ".", gob_indicators)), 
               ) %>%
        filter(is.na(CC.EST))

datos_paper %>% 
        filter(!iso2c %in% c('SS', 'ZW', 'BT', 'ER', 'GW', 'KP', 'LB', 'NG', 'PS', 'SO', 'VU', 'FM', 'KI', 'TL', 'CV', 'SB','SY'),
               !year %in% c(1995, 1996, 1997, 1998, 1999, 2000, 2023)) %>%
        select(iso2c, year, hdi, DT.ODA.ALLD.CD, DT.ODA.ALLD.KD, DT.ODA.ODAT.CD, DT.ODA.ODAT.KD, DT.ODA.ODAT.PC.ZS, 
               NY.GDP.PCAP.CN, NY.GDP.PCAP.CD, SP.POP.GROW, all_of(gsub("_", ".", gob_indicators)), 
               )

vis_dat(datos_paper %>% 
        filter(!iso2c %in% c('SS', 'ZW', 'BT', 'ER', 'GW', 'KP', 'LB', 'NG', 'PS', 'SO', 'VU', 'FM', 'KI', 'TL', 'CV', 'SB','SY'),
               !year %in% c(1995, 1996, 1997, 1998, 1999, 2000, 2023)) %>%
        select(iso2c, year, hdi, DT.ODA.ALLD.CD, DT.ODA.ALLD.KD, DT.ODA.ODAT.CD, DT.ODA.ODAT.KD, DT.ODA.ODAT.PC.ZS, 
               NY.GDP.PCAP.CN, NY.GDP.PCAP.CD, SP.POP.GROW, all_of(gsub("_", ".", gob_indicators)), 
               ))

vis_dat(datos_paper %>% 
        filter(!iso2c %in% c('SS', 'ZW', 'BT', 'ER', 'GW', 'KP', 'LB', 'NG', 'PS', 'SO', 'VU', 'FM', 'KI', 'TL', 'CV', 'SB','SY'),
               !year %in% c(1995, 1996, 1997, 1998, 1999, 2000, 2001, 2023)) %>%
        select(iso2c, year, hdi, DT.ODA.ALLD.CD, DT.ODA.ALLD.KD, DT.ODA.ODAT.CD, DT.ODA.ODAT.KD, DT.ODA.ODAT.PC.ZS, 
               NY.GDP.PCAP.CN, NY.GDP.PCAP.CD, SP.POP.GROW, all_of(gsub("_", ".", gob_indicators)), 
               ))
```
De 2232 observaciones reducimos a 1098 (2002 hasta 2019) o a 1260 (2002 hasta 2022)

Aplicar Operador diferencia

```{r}
datos_model <- datos_paper %>% 
        filter(!iso2c %in% c('SS', 'ZW', 'BT', 'ER', 'GW', 'KP', 'LB', 'NG', 'PS', 'SO', 'VU', 'FM', 'KI', 'TL', 'CV', 'SB', 'SY'),
               !year %in% c(1995, 1996, 1997, 1998, 1999, 2000, 2023)) %>%
        select(iso2c, year, hdi, DT.ODA.ALLD.CD, DT.ODA.ALLD.KD, DT.ODA.ODAT.CD, DT.ODA.ODAT.KD, DT.ODA.ODAT.PC.ZS, 
               NY.GDP.PCAP.CN, NY.GDP.PCAP.CD, SP.POP.GROW, all_of(gsub("_", ".", gob_indicators))
               )

datos_model <- datos_model %>% arrange(iso2c, year) %>% 
        mutate(hdi_diff = hdi - lag(hdi), 
               NY.GDP.PCAP.CN_diff = NY.GDP.PCAP.CN - lag(NY.GDP.PCAP.CN), 
               NY.GDP.PCAP.CD_diff = NY.GDP.PCAP.CD - lag(NY.GDP.PCAP.CD),
               DT.ODA.ALLD.CD_diff = DT.ODA.ALLD.CD - lag(DT.ODA.ALLD.CD),
               DT.ODA.ODAT.PC.ZS_diff = DT.ODA.ODAT.PC.ZS - lag(DT.ODA.ODAT.PC.ZS)) %>%
        filter(!year %in% c(2001))

vis_dat(datos_model)

```

# Modelos Regresion Lineal {.tabset .tabset-fade}
Probando modelos sencillos, regresion lineal, Minimos cuadrados, datos panel, HDI o GDP o sus differecias

## HDI <- ODA.ALL 
### HDI = ODA.ALL + CC + GE + PV + RQ + RL + VA + POP.GROW
```{r}
summary(lm(hdi ~ DT.ODA.ALLD.CD + CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST + SP.POP.GROW, data=datos_model))
# Todas las variables son significativas al 99% excepto Regulatory Quality
```

## HDI <- ODA.PC 
### HDI = ODA.PC + CC + GE + PV + RQ + RL + VA + POP.GROW
```{r}
summary(lm(hdi ~ DT.ODA.ODAT.PC.ZS + CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST + SP.POP.GROW, data=datos_model))
# Todas las variables son significativas al 99% excepto Regulatory Quality
```

## GPD.PC <- ODA.ALL 
### GPD.PC = ODA.ALL + CC + GE + PV + RQ + RL + VA + POP.GROW
```{r}
summary(lm(NY.GDP.PCAP.CD ~ DT.ODA.ALLD.CD + CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST + SP.POP.GROW, data=datos_model))
# Todas las variables son significativas al 99% excepto ODA.ALL, Control of Corruption, Regulatory Quality y Rule of Law
```

## GPD.PC <- ODA.PC
### GPD.PC = ODA.PC + CC + GE + PV + RQ + RL + VA + POP.GROW
```{r}
summary(lm(NY.GDP.PCAP.CD ~ DT.ODA.ODAT.PC.ZS + CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST + SP.POP.GROW, data=datos_model))
# Todas las variables son significativas al 99% excepto Rule of Law
```

# 

Se revisara las relaciones entre las variables graficamente

# Visualizacion de datos {.tabset .tabset-fade}
## HDI
```{r}
my_plot  <- list()

for (col in c('DT.ODA.ALLD.CD', 'DT.ODA.ODAT.PC.ZS', 'DT.ODA.ALLD.CD_diff', 'DT.ODA.ODAT.PC.ZS_diff', 
              'CC.EST', 'GE.EST', 'PV.EST', 'RQ.EST', 'RL.EST', 'VA.EST')) {
  my_plot[[col]] <- plot_ly(x = datos_model[[col]], y = datos_model[[3]], type = 'scatter', mode = 'markers', name = col)  
}
subplot(my_plot[1:4], nrows = 2, margin = 0.05) %>% layout(title = 'HDI vs ODA')
subplot(my_plot[5:10], nrows = 2, margin = 0.05) %>% layout(title = 'HDI vs GOB')
```

## HDI diff
```{r}
my_plot  <- list()

for (col in c('DT.ODA.ALLD.CD', 'DT.ODA.ODAT.PC.ZS', 'DT.ODA.ALLD.CD_diff', 'DT.ODA.ODAT.PC.ZS_diff', 
              'CC.EST', 'GE.EST', 'PV.EST', 'RQ.EST', 'RL.EST', 'VA.EST')) {
  my_plot[[col]] <- plot_ly(x = datos_model[[col]], y = datos_model[[48]], type = 'scatter', mode = 'markers', name = col)  
}
subplot(my_plot[1:4], nrows = 2, margin = 0.05) %>% layout(title = 'HDI diff vs ODA')
subplot(my_plot[5:10], nrows = 2, margin = 0.05) %>% layout(title = 'HDI diff vs GOB')
```

## GPD.PC
```{r}
my_plot  <- list()
for (col in c('DT.ODA.ALLD.CD', 'DT.ODA.ODAT.PC.ZS', 'DT.ODA.ALLD.CD_diff', 'DT.ODA.ODAT.PC.ZS_diff', 
              'CC.EST', 'GE.EST', 'PV.EST', 'RQ.EST', 'RL.EST', 'VA.EST')) {
  my_plot[[col]] <- plot_ly(x = datos_model[[col]], y = datos_model[[10]], type = 'scatter', mode = 'markers', name = col)  
}
subplot(my_plot[1:4], nrows = 2, margin = 0.05) %>% layout(title = 'GDP.PC vs ODA')
subplot(my_plot[5:10], nrows = 2, margin = 0.05) %>% layout(title = 'GDP.PC vs GOB')

```

## GPD.PC diff
```{r}
my_plot  <- list()
for (col in c('DT.ODA.ALLD.CD', 'DT.ODA.ODAT.PC.ZS', 'DT.ODA.ALLD.CD_diff', 'DT.ODA.ODAT.PC.ZS_diff', 
              'CC.EST', 'GE.EST', 'PV.EST', 'RQ.EST', 'RL.EST', 'VA.EST')) {
  my_plot[[col]] <- plot_ly(x = datos_model[[col]], y = datos_model[[50]], type = 'scatter', mode = 'markers', name = col)  
}
subplot(my_plot[1:4], nrows = 2, margin = 0.05) %>% layout(title = 'GDP.PC diff vs ODA')
subplot(my_plot[5:10], nrows = 2, margin = 0.05) %>% layout(title = 'GDP.PC diff vs GOB')

```

#

No se ve una relacion clara, hay tanto paises con punteos altos y bajos de GOB que tienen tanto HID altos o bajos
Quiza puede verse una leve relacion de mayor punteo en GOB acompañado de mejor punteo den HDI
Los datos de GPD si muestran una relacion positiva con el HDI visto en las graficas

Se realizara el mismo proceso con el crecimiento o decrecimiento de HDI anual (no se perderan datos al calcular la diferencia porque se añade el año 2001 en la seleccion)


# Visualizacion de Datos historia
Viendo la historia de las variables en el tiempo (por pais)
```{r}
datos_model %>% filter(iso2c == 'AF') %>% plot_ly(x = ~year) %>% 
  add_trace(y = ~hdi, type = 'scatter', mode = 'lines+markers', name = 'hdi') %>% 
  add_trace(y = ~NY.GDP.PCAP.CD / 1000, type = 'scatter', mode = 'lines+markers', name = 'gdp.pc') %>% 
  add_trace(y = ~DT.ODA.ALLD.CD / 10000000000, type = 'scatter', mode = 'lines+markers', name = 'ODA.ALL')  %>% 
  add_trace(y = ~DT.ODA.ODAT.PC.ZS / 1000, type = 'scatter', mode = 'lines+markers', name = 'ODA.PC')  %>% 
  add_trace(y = ~CC.EST, type = 'scatter', mode = 'lines+markers', name = 'CC') %>% 
  add_trace(y = ~GE.EST, type = 'scatter', mode = 'lines+markers', name = 'GE')  %>% 
  add_trace(y = ~PV.EST, type = 'scatter', mode = 'lines+markers', name = 'PV')  %>% 
  add_trace(y = ~RQ.EST, type = 'scatter', mode = 'lines+markers', name = 'RQ')  %>% 
  add_trace(y = ~RL.EST, type = 'scatter', mode = 'lines+markers', name = 'RL')  %>% 
  add_trace(y = ~VA.EST, type = 'scatter', mode = 'lines+markers', name = 'VA')
```

# Modelos Efectos fijos {.tabset .tabset-fade}

## HDI <- ODA.ALL

```{r}
summary(lm(hdi ~ DT.ODA.ALLD.CD + CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST + SP.POP.GROW + iso2c, data=datos_model))
#plm(hdi ~ DT.ODA.ALLD.CD + CC.EST + GE.EST + PV.EST + RQ.EST + RL.EST + VA.EST + SP.POP.GROW, data=datos_model,
#           index = c("iso2c", "year"), model = "within")
```

#